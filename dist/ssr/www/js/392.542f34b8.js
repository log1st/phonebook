"use strict";(self["webpackChunkphonebook"]=self["webpackChunkphonebook"]||[]).push([[392],{1879:(e,t,n)=>{n.d(t,{s:()=>r});var o=n(3673),a=n(2323),i=n(8880);const l={class:"text-h6"};function r(e,t,n,r,s,d){const u=(0,o.up)("q-input"),c=(0,o.up)("q-select"),p=(0,o.up)("q-card-section"),m=(0,o.up)("q-btn"),v=(0,o.up)("q-card-actions"),f=(0,o.up)("q-card"),w=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(w,{ref:"dialogRef",class:(0,a.C_)(e.$style.dialog),onHide:e.onDialogHide},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{tag:"form",onSubmit:(0,i.iM)(e.submit,["prevent"]),class:"q-dialog-plugin"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o._)("div",l,(0,a.zw)(e.id?"Редактирование":"Создание")+" департамента",1),(0,o.Wm)(u,{autofocus:"",modelValue:e.model.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.model.name=t),label:"Название"},null,8,["modelValue"]),(0,o.Wm)(c,{modelValue:e.model.parentId,"onUpdate:modelValue":t[1]||(t[1]=t=>e.model.parentId=t),options:e.departments.filter((t=>t.id!==e.id)),"option-value":"id","option-label":"name",label:"Родитель",clearable:"","map-options":"",disable:!e.id,autocomplete:""},null,8,["modelValue","options","disable"])])),_:1}),(0,o.Wm)(v,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{color:"primary",flat:"",label:"Отмена",onClick:e.onCancelClick},null,8,["onClick"]),(0,o.Wm)(m,{type:"submit",label:e.id?"Сохранить":"Создать",color:"primary",onClick:e.onOKClick,loading:e.isLoading},null,8,["label","onClick","loading"])])),_:1})])),_:1},8,["onSubmit"])])),_:1},8,["class","onHide"])}},943:(e,t,n)=>{n.d(t,{s:()=>y});var o=n(3673),a=n(2323);const i={class:"col-3 row column relative-position"},l={class:"row items-center q-pr-md"},r={class:"col-9 row"},s=(0,o.Uk)("Выберите департамент из списка"),d={key:"person-wrapper",class:"q-banner row col-grow relative-position"},u={key:"person-data",class:"row column"},c={class:"text-h3"},p={class:"text-h4 text-grey"},m={class:"row q-mt-md"},v={class:"row column q-ml-md col-grow"},f=(0,o._)("div",{class:"text-h5"},"Контакты",-1),w=(0,o._)("div",{class:"text-h5 q-mt-xl"},"Департаменты",-1),g={class:"q-banner row col-grow relative-position",key:"persons-wrap"},h=["src","alt"];function y(e,t,n,y,k,b){const _=(0,o.up)("q-btn"),D=(0,o.up)("q-spinner-gears"),q=(0,o.up)("q-inner-loading"),Z=(0,o.up)("q-tree"),W=(0,o.up)("q-scroll-area"),x=(0,o.up)("q-separator"),I=(0,o.up)("q-banner"),C=(0,o.up)("q-img"),P=(0,o.up)("q-avatar"),j=(0,o.up)("q-icon"),Q=(0,o.up)("q-item-section"),H=(0,o.up)("q-item-label"),z=(0,o.up)("q-item"),S=(0,o.up)("q-list"),U=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(U,{padding:"",class:"row"},{default:(0,o.w5)((()=>{var n,y,k,b,U;return[(0,o._)("div",i,[(0,o._)("div",l,[e.department&&!e.personId?((0,o.wg)(),(0,o.j4)(_,{key:0,"fab-mini":"",icon:"skip_previous",onClick:t[0]||(t[0]=t=>e.$router.push(`/${e.department.parentId||""}`)),class:"q-mr-sm"})):(0,o.kq)("",!0),(0,o.Wm)(_,{size:"lg","no-caps":"",flat:"",align:"left",disable:!e.personId,class:(0,a.C_)(["text-h5","self-start",!e.personId&&"no-pointer-events"]),to:{name:"index",params:{id:null===(n=e.department)||void 0===n?void 0:n.id}}},{default:(0,o.w5)((()=>{var t;return[(0,o.Uk)((0,a.zw)((null===(t=e.department)||void 0===t?void 0:t.name)||"Справочник"),1)]})),_:1},8,["disable","class","to"]),e.department?((0,o.wg)(),(0,o.j4)(_,{key:1,color:"orange",round:"",class:"q-ml-auto",icon:"edit",onClick:t[1]||(t[1]=t=>e.showDepartmentDialog(e.department))})):(0,o.kq)("",!0)]),(0,o.Wm)(W,{class:"col-grow q-mt-md"},{default:(0,o.w5)((()=>[e.isFetchingDepartments?((0,o.wg)(),(0,o.j4)(q,{key:0,showing:""},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{size:"50px",color:"primary"})])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(Z,{key:e.isFetchingDepartments?1:0,nodes:e.departments,"node-key":"id","no-nodes-label":e.isFetchingDepartments?"Загрузка...":"Нет ни одного департамента","default-expand-all":"",selected:e.selected,"onUpdate:selected":t[2]||(t[2]=t=>e.selected=t)},{"default-header":(0,o.w5)((({node:e})=>[(0,o.Uk)((0,a.zw)(e.name),1)])),_:1},8,["nodes","no-nodes-label","selected"])])),_:1}),(0,o.Wm)(_,{fab:"",color:"green",icon:"add",class:"absolute",style:{right:"10px",bottom:"10px"},onClick:t[3]||(t[3]=t=>{var n;return e.showDepartmentDialog({parentId:null===(n=e.department)||void 0===n?void 0:n.id})})}),e.departments.length>1?((0,o.wg)(),(0,o.j4)(_,{key:0,"fab-mini":"",color:"orange",icon:"sort",class:"absolute",style:{left:"10px",bottom:"10px"},onClick:t[4]||(t[4]=t=>{var n;return e.showDepartmentsSortDialog((null===(n=e.department)||void 0===n?void 0:n.id)||null)})})):(0,o.kq)("",!0)]),(0,o._)("div",r,[(0,o.Wm)(x,{class:"q-mr-md",vertical:"",key:"separator",inset:""}),e.id?e.personId?((0,o.wg)(),(0,o.iD)("div",d,[e.isFetchingPerson?((0,o.wg)(),(0,o.j4)(q,{showing:"",key:"fetching-person-gear"},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{size:"50px",color:"primary"})])),_:1})):((0,o.wg)(),(0,o.iD)("div",u,[(0,o._)("div",c,(0,a.zw)([null===(y=e.person)||void 0===y?void 0:y.firstName,null===(k=e.person)||void 0===k?void 0:k.middleName,null===(b=e.person)||void 0===b?void 0:b.lastName].filter(Boolean).join(" ")),1),(0,o._)("div",p,(0,a.zw)(null===(U=e.person)||void 0===U?void 0:U.position),1),(0,o._)("div",m,[(0,o.Wm)(P,{square:"",style:{borderRadius:"10px"},size:"300px"},{default:(0,o.w5)((()=>{var t,n;return[(0,o.Wm)(C,{src:null===(t=e.person)||void 0===t?void 0:t.photoUrl,alt:null===(n=e.person)||void 0===n?void 0:n.firstName},null,8,["src","alt"])]})),_:1}),(0,o._)("div",v,[f,(0,o.Wm)(S,{separator:"",bordered:"",class:"q-mt-md col-grow"},{default:(0,o.w5)((()=>{var t;return[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(null===(t=e.person)||void 0===t?void 0:t.contacts,(t=>((0,o.wg)(),(0,o.j4)(z,{clickable:"",onClick:n=>e.goToContact(t),key:t.id},{default:(0,o.w5)((()=>[(0,o.Wm)(Q,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(j,{name:{phone:"call",email:"email",address:"location_on"}[t.type]},null,8,["name"])])),_:2},1024),(0,o.Wm)(Q,null,{default:(0,o.w5)((()=>[(0,o.Wm)(H,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(t.value),1)])),_:2},1024),t.label?((0,o.wg)(),(0,o.j4)(H,{key:0,caption:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(t.label),1)])),_:2},1024)):(0,o.kq)("",!0)])),_:2},1024)])),_:2},1032,["onClick"])))),128))]})),_:1}),w,(0,o.Wm)(S,{class:"q-mt-md col-grow separator",separator:"",bordered:""},{default:(0,o.w5)((()=>{var t;return[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(null===(t=e.person)||void 0===t?void 0:t.departments,(t=>{var n;return(0,o.wg)(),(0,o.j4)(z,{to:`/${t.id}/${null===(n=e.person)||void 0===n?void 0:n.id}`,key:t.id},{default:(0,o.w5)((()=>[(0,o.Wm)(Q,null,{default:(0,o.w5)((()=>[(0,o.Wm)(H,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(t.name),1)])),_:2},1024),(0,o.Wm)(H,{caption:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(t.position),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["to"])})),128))]})),_:1})])])]))])):e.id?((0,o.wg)(),(0,o.iD)("div",g,[e.isFetchingPersons?((0,o.wg)(),(0,o.j4)(q,{key:"persons-loader",showing:""},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{size:"50px",color:"primary"})])),_:1})):((0,o.wg)(),(0,o.j4)(W,{class:"col-grow",key:"persons-wrapper"},{default:(0,o.w5)((()=>[(0,o.Wm)(S,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.persons,((t,n)=>((0,o.wg)(),(0,o.j4)(z,{key:t.id,to:`/${e.id}/${t.id}`},{default:(0,o.w5)((()=>[(0,o.Wm)(Q,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(P,{color:"primary"},{default:(0,o.w5)((()=>[(0,o._)("img",{src:t.photoUrl,alt:t.firstName},null,8,h)])),_:2},1024)])),_:2},1024),(0,o.Wm)(Q,null,{default:(0,o.w5)((()=>[(0,o.Wm)(H,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)([t.firstName,t.middleName,t.lastName].filter(Boolean).join(" ")),1)])),_:2},1024),(0,o.Wm)(H,{caption:"",lines:"1"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(t.position),1)])),_:2},1024)])),_:2},1024),(0,o.Wm)(Q,{side:"",top:""},{default:(0,o.w5)((()=>[(0,o.Wm)(H,{caption:""},{default:(0,o.w5)((()=>[(0,o.Uk)("№"+(0,a.zw)(n+1),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["to"])))),128))])),_:1})])),_:1}))])):(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(I,{key:"no-wrapper",class:"text-h4 col-grow text-center text-blue-10"},{default:(0,o.w5)((()=>[s])),_:1}))])]})),_:1})}},2150:(e,t,n)=>{n.d(t,{Z:()=>d});var o=n(3673),a=n(1959),i=n(9022),l=n(2734),r=function(e,t,n,o){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function l(e){try{s(o.next(e))}catch(t){i(t)}}function r(e){try{s(o["throw"](e))}catch(t){i(t)}}function s(e){e.done?n(e.value):a(e.value).then(l,r)}s((o=o.apply(e,t||[])).next())}))},s=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(n[o[a]]=e[o[a]])}return n};const d=(0,o.aZ)({name:"DepartmentDialog",props:{id:Number,parentId:Number},emits:[...i.Z.emits],setup(e){const{dialogRef:t,onDialogHide:n,onDialogOK:d,onDialogCancel:u}=(0,i.Z)(),c=()=>({name:"",order:0,parentId:e.parentId||null}),p=(0,a.iH)(c()),m=(0,a.iH)(!1),{fetchDepartment:v,fetchDepartments:f}=(0,l.h)(),w=(0,a.iH)([]);(0,o.bv)((()=>r(this,void 0,void 0,(function*(){const{status:e,response:t}=yield f({tree:!1});e&&(w.value=t.departments)}))));const{id:g}=(0,a.BK)(e);(0,o.YP)(g,(e=>r(this,void 0,void 0,(function*(){if(p.value=c(),!e)return;m.value=!0;const{status:t,response:n}=yield v({id:e});t&&(p.value=(e=>{var{id:t,children:n}=e,o=s(e,["id","children"]);return o})(n)),m.value=!1}))),{immediate:!0});const h=()=>r(this,void 0,void 0,(function*(){console.log(p.value)}));return{dialogRef:t,onDialogHide:n,onOKClick(){d()},onCancelClick:u,model:p,submit:h,departments:w,isLoading:m}}})},8655:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(3673),a=n(1959),i=n(2734),l=n(3793),r=n(6287),s=n(5163),d=function(e,t,n,o){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function l(e){try{s(o.next(e))}catch(t){i(t)}}function r(e){try{s(o["throw"](e))}catch(t){i(t)}}function s(e){e.done?n(e.value):a(e.value).then(l,r)}s((o=o.apply(e,t||[])).next())}))};const u=(0,o.aZ)({name:"PageIndex",props:{id:Number,personId:Number},setup(e){const{id:t,personId:n}=(0,a.BK)(e),u=(0,a.iH)(null),c=(0,a.iH)(!0),p=(0,a.iH)(null),m=(0,a.iH)(!0),v=(0,a.iH)([]),f=(0,a.iH)(!0),w=(0,a.iH)([]),g=(0,a.iH)(!0),{fetchDepartment:h,fetchDepartments:y,fetchDepartmentPersons:k,fetchDepartmentPerson:b}=(0,i.h)();(0,o.YP)(t,(e=>{requestAnimationFrame((()=>d(this,void 0,void 0,(function*(){f.value=!0;const{status:t,response:n}=yield y({parentId:e||null});f.value=!1,t&&(v.value=n.departments)}))))}),{immediate:!0}),(0,o.YP)(t,(e=>{requestAnimationFrame((()=>d(this,void 0,void 0,(function*(){if(!e)return void(u.value=null);c.value=!0;const{status:t,response:n}=yield h({id:e});c.value=!1,t&&(u.value=n)}))))}),{immediate:!0}),(0,o.YP)(t,(e=>{requestAnimationFrame((()=>d(this,void 0,void 0,(function*(){if(!e)return void(w.value=[]);g.value=!0;const{status:t,response:n}=yield k({id:e});g.value=!1,t&&(w.value=n.persons)}))))}),{immediate:!0}),(0,o.YP)((0,a.Fl)((()=>({personId:n.value,id:t.value}))),(({personId:e,id:t})=>{requestAnimationFrame((()=>d(this,void 0,void 0,(function*(){if(!e||!t)return void(p.value=null);m.value=!0;const{status:n,response:o}=yield b({id:t,personId:e});m.value=!1,n&&(p.value=o)}))))}),{immediate:!0});const _=(0,a.iH)(null),D=(0,l.tv)();(0,o.YP)(_,(e=>d(this,void 0,void 0,(function*(){e&&(yield D.push({name:"index",params:{id:e}}),_.value=null)}))));const q=e=>{e.type===r.u.address?window.open(`https://www.google.com/maps/search/test/${e.value}`,"_blank"):e.type===r.u.email?window.open(`mailto:${e.value}`):e.type===r.u.phone&&window.open(`tel:+${e.value}`)},{isEditing:Z,showDepartmentDialog:W,showDepartmentsSortDialog:x}=(0,s.j)();return{department:u,departments:v,isFetchingDepartments:f,isFetchingPersons:g,isFetchingPerson:m,isFetchingDepartment:c,selected:_,persons:w,person:p,goToContact:q,isEditing:Z,showDepartmentDialog:W,showDepartmentsSortDialog:x}}})},2734:(e,t,n)=>{n.d(t,{h:()=>i});var o=n(2394),a=function(e,t,n,o){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function l(e){try{s(o.next(e))}catch(t){i(t)}}function r(e){try{s(o["throw"](e))}catch(t){i(t)}}function s(e){e.done?n(e.value):a(e.value).then(l,r)}s((o=o.apply(e,t||[])).next())}))};const i=()=>{const e=(0,o.useStore)(),t=({tree:t=!0,parentId:n}={})=>a(void 0,void 0,void 0,(function*(){return e.dispatch("departments/fetchDepartments",{tree:t,parentId:n})})),n=t=>a(void 0,void 0,void 0,(function*(){return e.dispatch("departments/fetchDepartment",t)})),i=t=>a(void 0,void 0,void 0,(function*(){return e.dispatch("departments/fetchDepartmentPersons",t)})),l=t=>a(void 0,void 0,void 0,(function*(){return e.dispatch("departments/fetchDepartmentPerson",t)}));return{fetchDepartments:t,fetchDepartment:n,fetchDepartmentPerson:l,fetchDepartmentPersons:i}}},5163:(e,t,n)=>{n.d(t,{j:()=>r});var o=n(2394),a=n(1959),i=n(8075),l=n(969);const r=()=>{const e=(0,o.useStore)(),t=(0,a.Fl)({get(){return e.getters.isEditing},set(t){e.commit("setIsEditing",t)}}),n=(0,i.Z)(),r=e=>{n.dialog({title:"Редактирование департамента",component:l.Z,componentProps:e})},s=e=>{console.log(e)};return{isEditing:t,showDepartmentDialog:r,showDepartmentsSortDialog:s}}},6287:(e,t,n)=>{var o;n.d(t,{u:()=>o}),function(e){e["phone"]="phone",e["email"]="email",e["address"]="address"}(o||(o={}))},969:(e,t,n)=>{n.d(t,{Z:()=>w});var o=n(6030),a=n(9601),i=n(7066),l=n(8757),r=n(7217),s=n(323),d=n(9804),u=n(9181),c=n(3479),p=n(648),m=n(7518),v=n.n(m);const f=a.Z.__cssModules={};f["$style"]=i.Z,a.Z.render=o.s;const w=a.Z;v()(a.Z,"components",{QDialog:l.Z,QCard:r.Z,QCardSection:s.Z,QInput:d.Z,QSelect:u.Z,QCardActions:c.Z,QBtn:p.Z})},1392:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var o=n(6047),a=n(7329),i=n(9376),l=n(648),r=n(9047),s=n(1259),d=n(6277),u=n(653),c=n(9878),p=n(6528),m=n(7794),v=n(7378),f=n(7364),w=n(4108),g=n(3583),h=n(7883),y=n(5466),k=n(7518),b=n.n(k);a.Z.render=o.s;const _=a.Z;b()(a.Z,"components",{QPage:i.Z,QBtn:l.Z,QScrollArea:r.Z,QInnerLoading:s.Z,QSpinnerGears:d.Z,QTree:u.Z,QSeparator:c.Z,QBanner:p.Z,QAvatar:m.Z,QImg:v.Z,QList:f.Z,QItem:w.Z,QItemSection:g.Z,QIcon:h.Z,QItemLabel:y.Z})},7489:(e,t,n)=>{n.d(t,{Z:()=>o});const o={dialog:"DepartmentDialog_dialog_kOVUc"}},6030:(e,t,n)=>{n.d(t,{s:()=>o.s});var o=n(1879)},6047:(e,t,n)=>{n.d(t,{s:()=>o.s});var o=n(943)},9601:(e,t,n)=>{n.d(t,{Z:()=>o.Z});var o=n(2150)},7329:(e,t,n)=>{n.d(t,{Z:()=>o.Z});var o=n(8655)},7066:(e,t,n)=>{n.d(t,{Z:()=>o.Z});var o=n(7489)}}]);